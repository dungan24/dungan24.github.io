---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - assets/css/custom.css
  - assets/css/custom/toc-and-effects.css
autonomous: true
requirements:
  - FOUN-01
  - FOUN-02
  - FOUN-03

must_haves:
  truths:
    - "custom.css에 :root:not(.dark) 블록이 정확히 하나만 존재한다"
    - ".mp-briefing-meta::before에 backdrop-filter 속성이 없다"
    - "prefers-reduced-motion 블록에 #TOCView와 .market-chart-card가 포함된다"
  artifacts:
    - path: "assets/css/custom.css"
      provides: "단일 :root:not(.dark) 블록 (89-104행 유지, 218-230행 제거)"
      contains: ":root:not(.dark)"
    - path: "assets/css/custom/toc-and-effects.css"
      provides: "::before nested blur 제거 + reduced-motion 접근성 추가"
      contains: "prefers-reduced-motion"
  key_links:
    - from: "assets/css/custom.css"
      to: ":root:not(.dark) (단일 블록)"
      via: "두 번째 중복 블록 삭제"
      pattern: ":root:not\\(\\.dark\\)"
    - from: "assets/css/custom/toc-and-effects.css"
      to: ".mp-briefing-meta::before"
      via: "backdrop-filter 두 줄 제거"
      pattern: "mp-briefing-meta::before"
    - from: "assets/css/custom/toc-and-effects.css"
      to: "@media (prefers-reduced-motion: reduce)"
      via: "#TOCView, .market-chart-card 선택자 추가"
      pattern: "TOCView"
---

<objective>
CSS 라이브 버그 3개를 수정한다: custom.css의 중복 :root:not(.dark) 블록 통합, .mp-briefing-meta::before의 nested backdrop-filter 제거, prefers-reduced-motion 블록 접근성 보완.

Purpose: 이 버그들은 현재 라이트 모드 변수 오버라이드 불일치(FOUN-01), 이중 블러 아티팩트(FOUN-02), 접근성 요건 미충족(FOUN-03)을 유발한다. Plan 02의 토큰 시스템 작업 전에 먼저 수정해야 안전한 기반이 된다.
Output: custom.css (중복 블록 제거), toc-and-effects.css (::before blur 제거 + reduced-motion 보완)
</objective>

<execution_context>
@C:/Users/sc/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/sc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/1-RESEARCH.md
@assets/css/custom.css
@assets/css/custom/toc-and-effects.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: custom.css 중복 :root:not(.dark) 블록 통합 (FOUN-01)</name>
  <files>assets/css/custom.css</files>
  <action>
    custom.css의 218-230행에 위치한 두 번째 `:root:not(.dark)` 블록을 삭제한다.

    현재 상태:
    - 첫 번째 블록 (89-104행): `--mp-brand-color`, `--mp-brand-color-rgb` 포함한 13개 변수
    - 두 번째 블록 (218-230행, 주석 "Light Mode — Minimal Cyberpunk"): `--mp-brand-color`, `--mp-brand-color-rgb` 누락한 11개 변수 (동일 값)

    수행할 작업:
    1. 두 번째 블록(218-230행)의 내용을 diff하여 첫 번째 블록에 없는 변수가 있는지 확인한다. 리서치에 따르면 두 번째 블록이 오히려 변수가 더 적으므로 첫 번째 블록이 superset이다.
    2. 두 번째 `:root:not(.dark)` 블록 전체를 삭제한다. 주석 "Light Mode — Minimal Cyberpunk"도 함께 삭제한다.
    3. 삭제 후 해당 위치(구 218행 근처)에 빈 줄 하나를 남겨 전후 규칙 사이 간격을 유지한다.

    주의:
    - 두 번째 블록 삭제 후 바로 이어지는 `:root:not(.dark) .briefing-section { ... }` 같은 선택자 규칙들은 건드리지 않는다. 이것들은 변수 선언 블록이 아니라 컴포넌트 스타일 규칙으로 유지된다.
    - 첫 번째 블록(89-104행)은 절대 수정하지 않는다. 이번 태스크의 전부는 "두 번째 블록 삭제"다.
  </action>
  <verify>
    다음 grep 명령으로 `:root:not(.dark)` 블록이 정확히 하나만 남았는지 확인한다:
    `grep -n "^:root:not(.dark) {" assets/css/custom.css`
    결과가 정확히 1줄이어야 한다 (89행 또는 그 근방).
  </verify>
  <done>
    `grep -c "^:root:not(.dark) {" assets/css/custom.css` 결과가 1이다.
    첫 번째 블록(13개 변수, --mp-brand-color 포함)이 그대로 존재한다.
  </done>
</task>

<task type="auto">
  <name>Task 2: toc-and-effects.css 버그 2종 수정 (FOUN-02, FOUN-03)</name>
  <files>assets/css/custom/toc-and-effects.css</files>
  <action>
    toc-and-effects.css에서 두 가지 독립적인 수정을 수행한다.

    **수정 A — FOUN-02: .mp-briefing-meta::before nested backdrop-filter 제거**

    현재 424-442행 근방의 `.mp-briefing-meta::before` 규칙:
    ```css
    .mp-briefing-meta::before {
      content: '// META';
      position: absolute;
      top: -10px;
      left: 12px;
      background: rgba(10, 10, 26, 0.85);
      -webkit-backdrop-filter: blur(8px);   /* ← 삭제 */
      backdrop-filter: blur(8px);           /* ← 삭제 */
      padding: 2px 10px;
      ...
    }
    ```

    `-webkit-backdrop-filter: blur(8px);` 와 `backdrop-filter: blur(8px);` 두 줄만 삭제한다.
    나머지 속성(`content`, `position`, `top`, `left`, `background`, `padding`, `font-family`, `font-size`, `font-weight`, `color`, `letter-spacing`, `text-transform`, `border`, `border-radius`, `z-index`)은 모두 유지한다.

    이유: `.mp-briefing-meta` 부모가 이미 `backdrop-filter: var(--mp-glass-blur)`를 가지므로, `::before` pseudo-element에 추가 backdrop-filter를 걸면 이중 블러 아티팩트가 발생한다.

    **수정 B — FOUN-03: prefers-reduced-motion 블록에 #TOCView, .market-chart-card 추가**

    현재 510-531행 근방의 `@media (prefers-reduced-motion: reduce)` 블록:
    ```css
    .briefing-section,
    .mp-ticker-group,
    .mp-briefing-card,
    .mp-news-card,
    .mp-post-hero {
      backdrop-filter: none;
      -webkit-backdrop-filter: none;
    }
    ```

    이 선택자 목록 끝에 `#TOCView`와 `.market-chart-card`를 추가한다:
    ```css
    .briefing-section,
    .mp-ticker-group,
    .mp-briefing-card,
    .mp-news-card,
    .mp-post-hero,
    #TOCView,
    .market-chart-card {
      backdrop-filter: none;
      -webkit-backdrop-filter: none;
    }
    ```

    `@media` 블록 안의 다른 규칙들(`body::after`, `.mp-home-shell::before`, `animate`, 등)은 건드리지 않는다.
  </action>
  <verify>
    1. `grep -n "backdrop-filter" assets/css/custom/toc-and-effects.css` 출력에서
       `.mp-briefing-meta::before` 관련 줄(blur(8px))이 없어야 한다.
    2. `grep -n "TOCView\|market-chart-card" assets/css/custom/toc-and-effects.css` 출력에서
       `prefers-reduced-motion` 블록 안에 두 선택자가 보여야 한다.
  </verify>
  <done>
    `.mp-briefing-meta::before` 규칙에 backdrop-filter 속성이 0개다.
    `#TOCView`와 `.market-chart-card`가 `@media (prefers-reduced-motion: reduce)` 블록의 backdrop-filter 선택자 목록에 포함된다.
  </done>
</task>

</tasks>

<verification>
두 파일 수정 완료 후 다음을 확인한다:

1. `grep -c "^:root:not(.dark) {" assets/css/custom.css` → 1
2. `grep -n "backdrop-filter: blur(8px)" assets/css/custom/toc-and-effects.css` → 빈 결과 (no matches)
3. `grep -A2 "TOCView" assets/css/custom/toc-and-effects.css` → `prefers-reduced-motion` 블록 내부에 위치 확인
4. Hugo 빌드 에러 없음: `hugo --gc --minify 2>&1 | grep -i error` → 빈 결과 또는 WARNING만
</verification>

<success_criteria>
- custom.css에 :root:not(.dark) 블록이 1개만 존재하고, --mp-brand-color와 --mp-brand-color-rgb가 포함된다
- toc-and-effects.css의 .mp-briefing-meta::before에 backdrop-filter, -webkit-backdrop-filter 속성이 없다
- toc-and-effects.css의 prefers-reduced-motion 블록이 #TOCView와 .market-chart-card를 backdrop-filter: none 선택자로 포함한다
- Hugo 빌드가 에러 없이 완료된다
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
