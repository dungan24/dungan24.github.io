---
phase: 04-component-redesign
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - assets/css/custom/chart-cards.css
  - config/_default/params.toml
autonomous: true
requirements:
  - CHRT-01
  - CHRT-02
  - CHRT-03

must_haves:
  truths:
    - "차트 컨테이너에 글래스 스타일(backdrop-filter, 테두리, box-shadow)이 적용되고 내부 .chart-box에는 backdrop-filter가 없다"
    - "params.toml의 palette 값이 custom.css CSS 변수와 동기화되어 있고 동기화 참조 코멘트가 문서화되었다"
    - "라이트 모드에서 차트 컨테이너 배경이 #ffffff이고 backdrop-filter가 none이다"
  artifacts:
    - path: "assets/css/custom/chart-cards.css"
      provides: "글래스 차트 컨테이너 dark/light 스타일"
      contains: "market-chart-card"
    - path: "config/_default/params.toml"
      provides: "ECharts 팔레트 색상 (CSS 변수 동기화 참조 코멘트 포함)"
      contains: "palette"
  key_links:
    - from: "config/_default/params.toml"
      to: "static/js/render-charts.js"
      via: "window.__MP_CONFIG.charts.palette → PALETTE object"
      pattern: "palette"
    - from: "static/js/render-charts.js"
      to: "assets/css/custom/chart-cards.css"
      via: "isDarkMode() checks .dark class on html"
      pattern: "isDarkMode"
---

<objective>
차트 컨테이너 글래스 스타일 확인/폴리시 + ECharts 팔레트 동기화 문서화 + 라이트 모드 최적화

Purpose: 차트 영역이 글래스 디자인 시스템과 일치하고, ECharts가 사용하는 params.toml 색상이 CSS 변수와 동기화 상태임을 문서화하며, 라이트 모드에서 차트가 깔끔하게 표시된다.
Output: 수정된 chart-cards.css + params.toml (코멘트 추가)
</objective>

<execution_context>
@C:/Users/sc/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/sc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-component-redesign/04-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: 차트 글래스 컨테이너 확인 + 팔레트 동기화 + 라이트 모드 최적화 (CHRT-01, CHRT-02, CHRT-03)</name>
  <files>assets/css/custom/chart-cards.css, config/_default/params.toml</files>
  <action>
**Part A — CSS: 글래스 컨테이너 확인/폴리시 (CHRT-01)**

chart-cards.css에서 `.market-chart-card`를 확인한다:
1. dark mode: `backdrop-filter: blur(12px)` 있어야 함 (최외곽 컨테이너이므로 OK)
2. `background: var(--mp-chart-card-bg)` 사용 확인 (custom.css에서 선언된 토큰)
3. `border`, `box-shadow` 글래스 토큰 사용 확인
4. 내부 `.chart-box`에 `backdrop-filter`가 없는지 확인 — 있으면 제거 (내부 카드 backdrop-filter 금지 원칙)

만약 `.market-chart-card`가 이미 올바르면 그대로 유지. 토큰 미사용 부분만 수정.

**Part B — params.toml: 팔레트 동기화 문서 코멘트 추가 (CHRT-02)**

팔레트 동기화 검증 결과:
- params.toml `palette.pink = "#FF3366"` → CSS `--mp-neon-pink: #FF3366` → 정확히 일치
- render-charts.js line 68: `success: dark ? COLORS.pink : COLORS.successLight` → pink는 **success/up** (한국 관례: 상승=빨강)
- CSS `--mp-color-up: var(--mp-neon-pink)` → pink = up = 올바른 매핑
- CSS `--mp-neon-rose: #F43F5E`는 **별도 색상 변수**로, ECharts 팔레트에는 사용되지 않음. pink와 혼동 금지.

**params.toml의 pink 값("#FF3366")을 변경하지 않는다** — 이미 올바르게 동기화되어 있다.

팔레트 섹션 위에 동기화 참조 코멘트를 추가한다:

```toml
# Chart palette — MUST stay in sync with assets/css/custom.css CSS variables
# primary = --mp-neon-purple (#7C3AED)
# cyan    = --mp-neon-cyan   (#00F0FF)
# pink    = --mp-neon-pink   (#FF3366) → --mp-color-up (dark mode success/상승)
# blue    = --mp-neon-blue   (#3388FF) → --mp-color-down (dark mode danger/하락)
# green   = --mp-neon-green  (#00FF88)
# yellow  = --mp-neon-yellow (#FFD600)
# NOTE: --mp-neon-rose (#F43F5E) is a SEPARATE CSS variable, NOT used in ECharts palette
# success_light = --mp-color-up (light mode), danger_light = --mp-color-down (light mode)
```

**Part C — CSS: 라이트 모드 최적화 확인 (CHRT-03)**

chart-cards.css의 `:root:not(.dark) .market-chart-card` 규칙을 확인한다:
1. `background: #ffffff` (또는 적절한 라이트 값)
2. `backdrop-filter: none` (라이트 모드에서 blur 불필요)
3. `border`, `box-shadow`가 라이트 모드에 맞는 값

이미 올바르면 유지. 누락된 부분만 추가.

`render-charts.js`의 `isDarkMode()` 함수가 `document.documentElement.classList.contains("dark")`를 사용하는지 확인 — 연구에서 이미 확인됨, 코드 변경 불필요.

**주의사항:**
- chart-cards.css에 `:root {}` 변수 선언 블록 추가 금지 (Phase 1 결정: custom.css만)
- `@media (prefers-color-scheme: dark)` 사용 금지
- render-charts.js는 수정하지 않음 — 이미 올바르게 동작
- `.chart-box` 등 내부 요소에 backdrop-filter 추가 금지
  </action>
  <verify>
1. Hugo 빌드 확인: `hugo --gc --minify 2>&1 | tail -5` (에러 0)
2. pink 값 확인: `grep 'pink' config/_default/params.toml` (값이 "#FF3366" 유지, 변경 없어야 함)
3. 동기화 코멘트 확인: `grep "MUST stay in sync" config/_default/params.toml`
4. 내부 backdrop-filter 부재 확인: `grep "backdrop-filter" assets/css/custom/chart-cards.css` (.market-chart-card에만 있어야 함, .chart-box에는 없어야 함)
5. `:root {}` 선언 블록 부재 확인: `grep "^:root {" assets/css/custom/chart-cards.css` (결과 없어야 함)
6. 라이트 모드 확인: `grep "root:not(.dark)" assets/css/custom/chart-cards.css` (존재해야 함)
  </verify>
  <done>
- .market-chart-card가 글래스 스타일(backdrop-filter, border, box-shadow) 사용, 내부 .chart-box에는 backdrop-filter 없음
- params.toml palette.pink이 "#FF3366"으로 CSS --mp-neon-pink (= --mp-color-up)와 올바르게 동기화 상태 유지
- params.toml palette 섹션에 CSS 변수 참조 코멘트 추가됨
- 라이트 모드에서 chart-card가 backdrop-filter: none + 적절한 배경/테두리 사용
  </done>
</task>

</tasks>

<verification>
1. Hugo 빌드 성공 (에러 0)
2. params.toml palette 값이 custom.css 값과 일치 (기존 동기화 유지 + 참조 코멘트 추가)
3. DevTools로 .market-chart-card 검사: dark mode에서 backdrop-filter 있음
4. DevTools로 .chart-box 검사: backdrop-filter 없음
5. 라이트 모드 전환 시 chart-card에 backdrop-filter: none
</verification>

<success_criteria>
- CHRT-01: 차트 컨테이너에 글래스 스타일이 적용되고 내부 요소에는 backdrop-filter 없음
- CHRT-02: params.toml 팔레트가 CSS 변수와 올바르게 동기화 상태 확인 + 동기화 참조 코멘트 추가
- CHRT-03: 라이트 모드에서 차트 컨테이너가 적절한 배경/테두리로 표시됨
</success_criteria>

<output>
After completion, create `.planning/phases/04-component-redesign/04-03-SUMMARY.md`
</output>
