{{/* Market Pulse Homepage - Hero + Tickers + Briefings */}}
{{ $mp := index .Site.Params "market_pulse" | default .Site.Params.market_pulse }}
{{ $paths := index $mp "paths" | default dict }}
{{ $postsPath := index $paths "posts" | default "posts/" }}
{{ $chartDataPrefix := index $paths "chart_data_prefix" | default "data/chart-data-" }}

<div class="mp-home-shell">
  <div class="mp-ambient-orbs">
    <div class="mp-ambient-orb mp-ambient-orb--left animate-pulse-slow"></div>
    <div class="mp-ambient-orb mp-ambient-orb--right animate-pulse-slower"></div>
  </div>

  <div class="mp-hud-corners">
    <div class="mp-hud-corner mp-hud-corner--tl"></div>
    <div class="mp-hud-corner mp-hud-corner--tr"></div>
    <div class="mp-hud-corner mp-hud-corner--bl"></div>
    <div class="mp-hud-corner mp-hud-corner--br"></div>
    <span class="mp-hud-status">SYS:ONLINE</span>
  </div>

  <div class="mp-home-content">
    <!-- Sticky Regime Badge (T-403) -->
    <div id="mp-sticky-regime" class="mp-sticky-regime">
      <span class="mp-sticky-regime-text">--</span>
    </div>

    <div class="mp-home-hero">
      <div class="mp-hero-title-row">
        <svg class="mp-ecg-pulse mp-ecg-pulse--left" viewBox="0 0 200 40" fill="none">
          <defs>
            <filter id="ecg-glow" x="-20%" y="-80%" width="140%" height="260%">
              <feGaussianBlur in="SourceGraphic" stdDeviation="1.5" result="blur1"/>
              <feGaussianBlur in="SourceGraphic" stdDeviation="4" result="blur2"/>
              <feMerge>
                <feMergeNode in="blur2"/>
                <feMergeNode in="blur1"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
          </defs>
          <path
            class="mp-ecg-line"
            filter="url(#ecg-glow)"
            d="M 0,20 L 55,20 L 62,16 L 70,20 L 78,20 L 82,23 L 86,3 L 90,37 L 94,20 L 106,20 L 114,13 L 122,20 L 200,20"
            stroke="#00F0FF"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>

        <h1 class="mp-heartbeat-title">
          <span class="mp-heartbeat">Market Pulse</span>
        </h1>

        <svg class="mp-ecg-pulse mp-ecg-pulse--right" viewBox="0 0 200 40" fill="none">
          <use href="#ecg-glow"/>
          <path
            class="mp-ecg-line mp-ecg-line--right"
            filter="url(#ecg-glow)"
            d="M 0,20 L 78,20 L 86,13 L 94,20 L 106,20 L 110,23 L 114,3 L 118,37 L 122,20 L 138,20 L 145,16 L 150,20 L 200,20"
            stroke="#00F0FF"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </div>

      <p class="mp-subtitle-flicker mp-subtitle-text">
        // FACT-DRIVEN MARKET INTELLIGENCE
      </p>

      <div id="mp-regime-badge" class="mp-regime-badge">--</div>
      <p id="mp-hero-summary" class="mp-hero-summary">
        <span class="mp-skeleton mp-skeleton--text mp-skeleton--hero-line"></span>
        <span class="mp-skeleton mp-skeleton--text-short mp-skeleton--hero-line-short"></span>
      </p>
      <p id="mp-hero-updated" class="mp-hero-updated"></p>
    </div>

    <h3 class="mp-section-header">Market Overview <span id="mp-live-status" class="mp-live-status"></span></h3>
    <div id="mp-ticker-groups" class="mp-ticker-groups" data-chart-data-prefix="{{ $chartDataPrefix | relURL }}">
      {{/* Skeleton Loading State */}}
      {{ range seq 3 }}
      <div class="mp-ticker-group">
        <div class="mp-skeleton mp-skeleton--text-short mp-skeleton--group-title"></div>
        <div class="mp-skeleton mp-skeleton--ticker-row"></div>
        <div class="mp-skeleton mp-skeleton--ticker-row"></div>
        <div class="mp-skeleton mp-skeleton--ticker-row"></div>
      </div>
      {{ end }}
    </div>
    <p id="mp-data-timestamp" class="mp-hero-updated mp-data-timestamp"></p>

    {{ partial "home/recent-briefings.html" . }}

    <div class="mp-more-wrap">
      <a href="{{ $postsPath | relURL }}" class="mp-more-link">
        전체 브리핑 보기 &rarr;
      </a>
    </div>
  </div>
</div>

<script src="{{ "js/home-market-overview.js" | relURL }}"></script>
